# 文章《面向多特性的加密流量分析关键技术研究》
## 挑战
1. 网络环境具有  动态性。真实网络存在丢包、重传、乱序等网络诱发现象,而这些现象会导致采集到的  网络流量特征改变,进而直接影响模型识别结果,导致误分类
2. 新型攻击存在未知  性。由于零日漏洞的存在,新型网络攻击层出不穷,这意味着无法事先收集到所有的攻  击数据,如何检测未知攻击是一个重要的挑战。
3. 流量样本类别增量性。
4. 攻击的全生命周期不仅仅涉及网络侧的入侵,还包括端侧(系统  侧)的恶意行为,这种跨源性导致仅从网络流量视角无法监测攻击的全生命周期。
5. 随着攻防  双方不断博弈,攻击种类越来越多,攻击知识库不断变得庞大。

## ERNN --> 针对网络的动态性特点，网络中存在很多传输延迟、数据包丢失、数据包乱序以及可变采样/传输间隔现象

假设 n（模型分析的最大数据包数量）设置为 10。
想象一个简短的加密流量会话（例如，一次快速的 DNS 查询或心跳包通信），该会话总共产生了 7 个数据包，它们的长度（以字节为单位）依次是：
| 顺序 | 包长度 (字节) | 含义 (举例) |
|:----|:---:|:----|
| P1  | 1514  | 客户端发送的一个大文件分段（接近最大传输单元 MTU）  |
| P2  |60  | 服务器回复的 SYN/ACK 包  |
| P3  | 52  | 客户端回复的 ACK 确认包  |
| P4  | 1000  | 客户端发送的第二个数据段  |
| P5  | 52  | 服务器回复的 ACK 确认包  |
| P6  | 1500  | 	客户端发送的第三个数据段  |
| P7  | 60  | 服务器发送的 FIN/ACK（结束通信）  |


由于 n=10，但实际只有 7 个数据包，所以需要进行填充。
最终的 ERNN 包长度序列（特征向量）将是：
L=[1514,60,52,1000,52,1500,60,0,0,0]
<img src="Screenshot 2025-10-30 190544.png" >
1. 模拟丢包（忽略动作）： 会话门会模拟忽略当前时间步的输入包长度，直接将状态转移到下一个时间步
2. 模拟重传（重复动作）： 会话门会重复一次当前时间步的计算过程，模拟数据包被再次使用的情形
3. 模拟乱序（整形动作）： 会话门会引入随机噪声来修改序列中某些数据包的属性值（例如包长度），以减少模型对原始数据包顺序组合的依赖，从而提高模型应对乱序现象的泛化能力
## 基线
1. SLC-RF使用消息类型和数据包长度马尔可夫模型的输出概率作为特征,使用随机森林对加密流量进行分类。
2. FS-Net使用 GRU模型学习序列特征,对常见应用进行分类。
3. 由于 ERNN 的设计是以传统  的 LSTM 作为骨干架构,因此也考虑了正常的 LSTM 模型作为对比模型。
